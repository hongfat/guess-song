<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŒœæ­Œç‹ - 1990å¹´ä»¥å‰</title>
    <style>
        /* åŸºç¤è¨­å®š */
        body {
            margin: 0;
            padding: 0;
            background-color: #1a1a1a;
            color: #ffffff;
            font-family: "Microsoft JhengHei", sans-serif;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
        }

        /* é¡Œè™Ÿèˆ‡æ–‡å­— */
        .stage-label { font-size: 3rem; color: #f39c12; margin-bottom: 20px; letter-spacing: 5px; }
        .main-content { font-size: 6rem; font-weight: bold; text-shadow: 0 0 20px rgba(255,255,255,0.2); }
        .sub-content { font-size: 3rem; color: #bdc3c7; margin-top: 30px; opacity: 0; transition: opacity 0.5s ease; }
        .sub-content.show { opacity: 1; }

        /* éš±è—çš„ YouTube æ’­æ”¾å™¨ (è¨­ç‚ºé€æ˜æˆ–æ¥µå°ï¼Œä½†ä¸èƒ½ display:none å¦å‰‡ç„¡æ³•æ’­æ”¾) */
        #player-container {
            position: absolute;
            top: -9999px;
            width: 1px;
            height: 1px;
            opacity: 0;
        }

        /* æ’­æ”¾ç‹€æ…‹æŒ‡ç¤ºç‡ˆ */
        .status-indicator {
            margin-top: 50px;
            font-size: 1.5rem;
            color: #555;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .status-indicator.playing { color: #2ecc71; text-shadow: 0 0 10px #2ecc71; }
        
        /* æ³¢å½¢å‹•ç•« (è£é£¾ç”¨) */
        .wave {
            display: inline-block;
            width: 5px; height: 20px; background: #2ecc71;
            animation: wave 1s infinite ease-in-out;
            visibility: hidden;
        }
        .status-indicator.playing .wave { visibility: visible; }
        @keyframes wave { 0%, 100% { height: 10px; } 50% { height: 30px; } }

        /* åº•éƒ¨æ“ä½œæç¤º */
        .footer-hint { position: absolute; bottom: 20px; font-size: 1rem; color: #555; }
        
        /* ç•¶å…¬å¸ƒç­”æ¡ˆæ™‚ï¼Œå¦‚æœæƒ³ç§€å‡º MVï¼Œå¯ä»¥é€é JS åŠ é€™å€‹ class */
        #player-container.reveal {
            position: relative;
            top: 20px;
            width: 640px;
            height: 360px;
            opacity: 1;
            z-index: 10;
            transition: all 0.5s;
            border: 5px solid #fff;
        }
    </style>
</head>
<body>

    <div id="container">
        <div id="stage" class="stage-label">æº–å‚™å¥½äº†å—ï¼Ÿ</div>
        <div id="main" class="main-content">çŒœæ­Œç‹å¤§è³½</div>
        <div id="sub" class="sub-content"></div>
        
        <div id="status" class="status-indicator">
            <span class="wave" style="animation-delay: 0s"></span>
            <span class="wave" style="animation-delay: 0.1s"></span>
            <span class="wave" style="animation-delay: 0.2s"></span>
            <span id="status-text">éŸ³æ¨‚å·²å¾…å‘½</span>
            <span class="wave" style="animation-delay: 0.2s"></span>
            <span class="wave" style="animation-delay: 0.1s"></span>
            <span class="wave" style="animation-delay: 0.0s"></span>
        </div>
    </div>

    <div id="player-container">
        <div id="player"></div>
    </div>

    <div class="footer-hint">
        [ç©ºç™½éµ] æ’­æ”¾/æš«åœ | [â†’] ä¸‹ä¸€é¡Œ | [Enter] é¡¯ç¤ºMV | F11 å…¨è¢å¹•
    </div>

    <script src="https://www.youtube.com/iframe_api"></script>

    <script>
        // ==========================================
        // ğŸµ æ­Œå–®è¨­å®šå€ (åªè¦æ”¹é€™è£¡ï¼)
        // ==========================================
        // videoId: ç¶²å€ "v=" å¾Œé¢çš„ä»£ç¢¼
        // start: å¾ç¬¬å¹¾ç§’é–‹å§‹æ’­ (t=60å°±æ˜¯60ç§’å¾Œé–‹å§‹)
        const songList = [
            { 
                question: "ç¬¬ 1 é¡Œ", 
                answer: "é’è˜‹æœæ¨‚åœ’", 
                artist: "å°è™éšŠ", 
                year: "1989å¹´",
                videoId: "UPFeAndsDRQ", // YTé€£çµ ID
                start: 56 // é–‹å§‹æ™‚é–“
            },
            { 
                question: "ç¬¬ 2 é¡Œ", 
                answer: "äº”æœˆåä¸€å½¼ä¸‹åŸ”", 
                artist: "æ²ˆæ–‡ç¨‹",
                year: "1998å¹´",
                videoId: "_cc1UP1zJCg", // YTé€£çµ ID
                start: 60 // é–‹å§‹æ™‚é–“
            },
            { 
                question: "ç¬¬ 3 é¡Œ", 
                answer: "äº”æœˆåä¸€å½¼ä¸‹åŸ”", 
                artist: "æ²ˆæ–‡ç¨‹", 
                videoId: "_cc1UP1zJCg", // YTé€£çµ ID
                start: 60 // é–‹å§‹æ™‚é–“
            },
            // è¤‡è£½ä¸Šé¢æ ¼å¼æ–°å¢...
        ];

        // ==========================================
        // ç³»çµ±é‚è¼¯å€
        // ==========================================
        let player;
        let currentIndex = -1; 
        let state = 'question'; // question, answer
        let isPlaying = false;

        // 1. YouTube API æº–å‚™å°±ç·’
        function onYouTubeIframeAPIReady() {
            // æŠ“å–ç›®å‰ç¶²å€çš„ domain (è§£æ±º origin å•é¡Œ)
            var currentOrigin = window.location.origin; 
            if (currentOrigin === 'null' || currentOrigin === 'file://') {
                document.getElementById('status-text').textContent = "âš ï¸ è­¦å‘Šï¼šè«‹ä½¿ç”¨ Local Server é–‹å•Ÿï¼Œä¸è¦ç›´æ¥é–‹æª”æ¡ˆ";
                document.getElementById('status').style.color = "red";
            }

            player = new YT.Player('player', {
                height: '360',
                width: '640',
                videoId: '', 
                playerVars: {
                    'controls': 0,
                    'showinfo': 0,
                    'rel': 0,
                    'origin': currentOrigin, // é—œéµä¿®æ­£ï¼šåŠ ä¸Šä¾†æº
                    'enablejsapi': 1
                },
                events: {
                    'onStateChange': onPlayerStateChange,
                    'onError': onPlayerError // æ–°å¢éŒ¯èª¤ç›£è½
                }
            });
        }

        // æ–°å¢ï¼šéŒ¯èª¤è™•ç†å‡½å¼
        function onPlayerError(event) {
            const statusText = document.getElementById('status-text');
            let errorMsg = "";
            switch(event.data) {
                case 2: errorMsg = "ç„¡æ•ˆçš„å½±ç‰‡ ID"; break;
                case 5: errorMsg = "HTML5 æ’­æ”¾å™¨éŒ¯èª¤"; break;
                case 100: errorMsg = "æ‰¾ä¸åˆ°å½±ç‰‡ (å¯èƒ½è¢«åˆªé™¤)"; break;
                case 101: 
                case 150: errorMsg = "æ­¤å½±ç‰‡ç¦æ­¢åµŒå…¥ (è«‹æ›ä¸€å€‹ä¾†æº)"; break;
                default: errorMsg = "æœªçŸ¥éŒ¯èª¤ä»£ç¢¼: " + event.data;
            }
            statusText.textContent = "âŒ éŒ¯èª¤: " + errorMsg;
            document.getElementById('status').style.color = "#e74c3c";
            
            // è‡ªå‹•å½ˆå‡ºæ’­æ”¾å™¨è®“ä½ çœ‹éŒ¯èª¤è¨Šæ¯
            document.getElementById('player-container').classList.add('reveal');
        }

        // ç›£è½æ’­æ”¾ç‹€æ…‹æ”¹è®ŠæŒ‡ç¤ºç‡ˆ
        function onPlayerStateChange(event) {
            const statusDiv = document.getElementById('status');
            const statusText = document.getElementById('status-text');
            if (event.data == YT.PlayerState.PLAYING) {
                statusDiv.classList.add('playing');
                statusText.textContent = "ç¾æ­£æ’­æ”¾ä¸­...";
                isPlaying = true;
            } else {
                statusDiv.classList.remove('playing');
                statusText.textContent = "éŸ³æ¨‚æš«åœ";
                isPlaying = false;
            }
        }

        // 2. ç•«é¢æ¸²æŸ“èˆ‡éŸ³æ¨‚ Cue é»
        function render() {
            const stageEl = document.getElementById('stage');
            const mainEl = document.getElementById('main');
            const subEl = document.getElementById('sub');
            const playerContainer = document.getElementById('player-container');

            // éš±è— MV (é‡ç½®ç‹€æ…‹)
            playerContainer.classList.remove('reveal');

            if (currentIndex === -1) {
                stageEl.textContent = "Welcome";
                mainEl.textContent = "çŒœæ­Œç‹å¤§è³½";
                subEl.textContent = "æŒ‰ [â†’] é–‹å§‹";
                subEl.classList.add('show');
                return;
            }

            if (currentIndex >= songList.length) {
                stageEl.textContent = "Game Over";
                mainEl.textContent = "æ´»å‹•çµæŸ";
                subEl.textContent = "";
                // åœæ­¢éŸ³æ¨‚
                if(player && player.stopVideo) player.stopVideo();
                return;
            }

            const currentSong = songList[currentIndex];

            if (state === 'question') {
                stageEl.textContent = "Question";
                mainEl.textContent = currentSong.question;
                mainEl.style.color = "#ffffff";
                subEl.textContent = "???";
                subEl.classList.remove('show');

                // é‡è¦ï¼šè¼‰å…¥éŸ³æ¨‚ä½†ä¸æ’­æ”¾ (Cue)
                if (player && player.cueVideoById) {
                    player.cueVideoById({
                        videoId: currentSong.videoId,
                        startSeconds: currentSong.start
                    });
                    document.getElementById('status-text').textContent = "éŸ³æ¨‚å·²å°±ç·’ (æŒ‰ç©ºç™½éµæ’­æ”¾)";
                }

            } else {
                stageEl.textContent = "Answer";
                mainEl.textContent = currentSong.answer;
                mainEl.style.color = "#2ecc71";
                subEl.innerHTML = currentSong.artist + (currentSong.year ? '<br>' + currentSong.year : '');
                subEl.classList.add('show');
                // ç­”æ¡ˆæ­æ›‰æ™‚ï¼Œä¸ä¸€å®šè¦è‡ªå‹•åœæ­¢ï¼Œçœ‹ä¸»æŒäººæƒ³ä¸æƒ³ç¹¼çºŒæ’­
            }
        }

        // 3. éµç›¤æ§åˆ¶
        document.addEventListener('keydown', (e) => {
            // [ç©ºç™½éµ]: æ’­æ”¾ / æš«åœ (æœ€é‡è¦åŠŸèƒ½)
            if (e.code === 'Space') {
                e.preventDefault(); // é˜²æ­¢æ²å‹•é é¢
                if (player && player.getPlayerState) {
                    const playerState = player.getPlayerState();
                    if (playerState === 1) { // æ­£åœ¨æ’­
                        player.pauseVideo();
                    } else { // æ²’åœ¨æ’­
                        player.playVideo();
                    }
                }
            }

            // [å³éµ]: ä¸‹ä¸€éšæ®µ
            if (e.code === 'ArrowRight') {
                if (currentIndex === -1) {
                    currentIndex = 0;
                    state = 'question';
                } else if (state === 'question') {
                    state = 'answer';
                } else {
                    currentIndex++;
                    state = 'question';
                }
                render();
            }

            // [Enter]: ç§€å‡º MV ç•«é¢ (å½©è›‹åŠŸèƒ½)
            if (e.code === 'Enter') {
                const playerContainer = document.getElementById('player-container');
                playerContainer.classList.toggle('reveal');
            }
        });

        // åˆå§‹åŒ–
        window.onload = render;
    </script>
</body>
</html>